// Code generated by kaitai-struct-compiler from a .ksy source file. DO NOT EDIT.

package generated

import "github.com/kaitai-io/kaitai_struct_go_runtime/kaitai"

type Actions struct {
	Version uint16
	Context *Bstr
	Actions []*Actions_Action
	_io *kaitai.Stream
	_root *Actions
	_parent interface{}
}
func NewActions() *Actions {
	return &Actions{
	}
}

func (this *Actions) Read(io *kaitai.Stream, parent interface{}, root *Actions) (err error) {
	this._io = io
	this._parent = parent
	this._root = root

	tmp1, err := this._io.ReadU2le()
	if err != nil {
		return err
	}
	this.Version = uint16(tmp1)
	if (this.Version == 3) {
		tmp2 := NewBstr()
		err = tmp2.Read(this._io, this, nil)
		if err != nil {
			return err
		}
		this.Context = tmp2
	}
	for i := 1;; i++ {
		tmp3, err := this._io.EOF()
		if err != nil {
			return err
		}
		if tmp3 {
			break
		}
		tmp4 := NewActions_Action()
		err = tmp4.Read(this._io, this, this._root)
		if err != nil {
			return err
		}
		this.Actions = append(this.Actions, tmp4)
	}
	return err
}
type Actions_ComHandlerProperties struct {
	Clsid []byte
	Data *Bstr
	_io *kaitai.Stream
	_root *Actions
	_parent *Actions_Action
}
func NewActions_ComHandlerProperties() *Actions_ComHandlerProperties {
	return &Actions_ComHandlerProperties{
	}
}

func (this *Actions_ComHandlerProperties) Read(io *kaitai.Stream, parent *Actions_Action, root *Actions) (err error) {
	this._io = io
	this._parent = parent
	this._root = root

	tmp5, err := this._io.ReadBytes(int(16))
	if err != nil {
		return err
	}
	tmp5 = tmp5
	this.Clsid = tmp5
	tmp6 := NewBstr()
	err = tmp6.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.Data = tmp6
	return err
}
type Actions_EmailTaskProperties struct {
	From *Bstr
	To *Bstr
	Cc *Bstr
	Bcc *Bstr
	ReplyTo *Bstr
	Server *Bstr
	Subject *Bstr
	Body *Bstr
	NumAttachmentFilenames uint32
	AttachmentFilenames []*Bstr
	NumHeaders uint32
	Headers []*Actions_KeyValueString
	_io *kaitai.Stream
	_root *Actions
	_parent *Actions_Action
}
func NewActions_EmailTaskProperties() *Actions_EmailTaskProperties {
	return &Actions_EmailTaskProperties{
	}
}

func (this *Actions_EmailTaskProperties) Read(io *kaitai.Stream, parent *Actions_Action, root *Actions) (err error) {
	this._io = io
	this._parent = parent
	this._root = root

	tmp7 := NewBstr()
	err = tmp7.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.From = tmp7
	tmp8 := NewBstr()
	err = tmp8.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.To = tmp8
	tmp9 := NewBstr()
	err = tmp9.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.Cc = tmp9
	tmp10 := NewBstr()
	err = tmp10.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.Bcc = tmp10
	tmp11 := NewBstr()
	err = tmp11.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.ReplyTo = tmp11
	tmp12 := NewBstr()
	err = tmp12.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.Server = tmp12
	tmp13 := NewBstr()
	err = tmp13.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.Subject = tmp13
	tmp14 := NewBstr()
	err = tmp14.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.Body = tmp14
	tmp15, err := this._io.ReadU4le()
	if err != nil {
		return err
	}
	this.NumAttachmentFilenames = uint32(tmp15)
	for i := 0; i < int(this.NumAttachmentFilenames); i++ {
		_ = i
		tmp16 := NewBstr()
		err = tmp16.Read(this._io, this, nil)
		if err != nil {
			return err
		}
		this.AttachmentFilenames = append(this.AttachmentFilenames, tmp16)
	}
	tmp17, err := this._io.ReadU4le()
	if err != nil {
		return err
	}
	this.NumHeaders = uint32(tmp17)
	for i := 0; i < int(this.NumHeaders); i++ {
		_ = i
		tmp18 := NewActions_KeyValueString()
		err = tmp18.Read(this._io, this, this._root)
		if err != nil {
			return err
		}
		this.Headers = append(this.Headers, tmp18)
	}
	return err
}
type Actions_KeyValueString struct {
	Key *Bstr
	Value *Bstr
	_io *kaitai.Stream
	_root *Actions
	_parent *Actions_EmailTaskProperties
}
func NewActions_KeyValueString() *Actions_KeyValueString {
	return &Actions_KeyValueString{
	}
}

func (this *Actions_KeyValueString) Read(io *kaitai.Stream, parent *Actions_EmailTaskProperties, root *Actions) (err error) {
	this._io = io
	this._parent = parent
	this._root = root

	tmp19 := NewBstr()
	err = tmp19.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.Key = tmp19
	tmp20 := NewBstr()
	err = tmp20.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.Value = tmp20
	return err
}
type Actions_ExeTaskProperties struct {
	Command *Bstr
	Arguments *Bstr
	WorkingDirectory *Bstr
	Flags uint16
	_io *kaitai.Stream
	_root *Actions
	_parent *Actions_Action
}
func NewActions_ExeTaskProperties() *Actions_ExeTaskProperties {
	return &Actions_ExeTaskProperties{
	}
}

func (this *Actions_ExeTaskProperties) Read(io *kaitai.Stream, parent *Actions_Action, root *Actions) (err error) {
	this._io = io
	this._parent = parent
	this._root = root

	tmp21 := NewBstr()
	err = tmp21.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.Command = tmp21
	tmp22 := NewBstr()
	err = tmp22.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.Arguments = tmp22
	tmp23 := NewBstr()
	err = tmp23.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.WorkingDirectory = tmp23
	if (this._root.Version == 3) {
		tmp24, err := this._io.ReadU2le()
		if err != nil {
			return err
		}
		this.Flags = uint16(tmp24)
	}
	return err
}
type Actions_MessageboxTaskProperties struct {
	Caption *Bstr
	Content *Bstr
	_io *kaitai.Stream
	_root *Actions
	_parent *Actions_Action
}
func NewActions_MessageboxTaskProperties() *Actions_MessageboxTaskProperties {
	return &Actions_MessageboxTaskProperties{
	}
}

func (this *Actions_MessageboxTaskProperties) Read(io *kaitai.Stream, parent *Actions_Action, root *Actions) (err error) {
	this._io = io
	this._parent = parent
	this._root = root

	tmp25 := NewBstr()
	err = tmp25.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.Caption = tmp25
	tmp26 := NewBstr()
	err = tmp26.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.Content = tmp26
	return err
}
type Actions_Action struct {
	Magic uint16
	Id *Bstr
	Properties interface{}
	_io *kaitai.Stream
	_root *Actions
	_parent *Actions
}
func NewActions_Action() *Actions_Action {
	return &Actions_Action{
	}
}

func (this *Actions_Action) Read(io *kaitai.Stream, parent *Actions, root *Actions) (err error) {
	this._io = io
	this._parent = parent
	this._root = root

	tmp27, err := this._io.ReadU2le()
	if err != nil {
		return err
	}
	this.Magic = uint16(tmp27)
	tmp28 := NewBstr()
	err = tmp28.Read(this._io, this, nil)
	if err != nil {
		return err
	}
	this.Id = tmp28
	switch (this.Magic) {
	case 26214:
		tmp29 := NewActions_ExeTaskProperties()
		err = tmp29.Read(this._io, this, this._root)
		if err != nil {
			return err
		}
		this.Properties = tmp29
	case 30583:
		tmp30 := NewActions_ComHandlerProperties()
		err = tmp30.Read(this._io, this, this._root)
		if err != nil {
			return err
		}
		this.Properties = tmp30
	case 34952:
		tmp31 := NewActions_EmailTaskProperties()
		err = tmp31.Read(this._io, this, this._root)
		if err != nil {
			return err
		}
		this.Properties = tmp31
	case 39321:
		tmp32 := NewActions_MessageboxTaskProperties()
		err = tmp32.Read(this._io, this, this._root)
		if err != nil {
			return err
		}
		this.Properties = tmp32
	}
	return err
}
